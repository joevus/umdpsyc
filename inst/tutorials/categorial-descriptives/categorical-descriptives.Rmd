---
title: "Categorical Descriptive Statistics"
output: 
  learnr::tutorial:
    progressive: true
runtime: shiny_prerendered

tutorial:
  id: "categorical-descriptives"
  version: 0.5
---


```{r setup, include=FALSE}
library(ggplot2)
library(umdpsyc)
library(learnr)
library(gradethis)
data(mtcars)
data("exam_scores")
knitr::opts_chunk$set(exercise.checker = gradethis::grade_learnr)
knitr::opts_chunk$set(echo = FALSE)
# learnr::tutorial_options(exercise.timelimit = 60)
```

## Categorical Descriptive Statistics

###

One of the first steps that you might take once you have some data in R is to look at descriptive statistics. Remember, the types of descriptive statistics that you use will be different depending on whether it is categorical or numerical data. We will look at categorical descriptive statistics and graphs here; check out the `numerical-descriptives` tutorial in order to learn about how to do descriptive statistics and graphs for numerical data.

For the examples in this tutorial, we use the `exam_scores` dataset. 

```{r}
head(exam_scores)
```


## Tables

###

One of the basic first steps you can take to summarize categorical variables is using a table to look at the counts within each category. 

```{r, echo = TRUE}
table(exam_scores$note_mode)
```

Here, we see that there are 45 in each group, meaning 45 people took notes by paper, and 45 took notes by computer.

### Two-way table

Many times, we're interested in seeing a two-way table with two categorical variables, showing how the different combinations of categories stack up. We can do this as well using the `table` function by simply adding another variable as another argument.

```{r, echo = TRUE}
table(exam_scores$anxiety,exam_scores$note_mode)
```

Here, we are essentially passing two vectors as arguments to the `table` function: The `exam_scores$anxiety` vector extracted from the `exam_score` data frame, and the `exam_scores$note_mode` vector extracted from the `exam_scores` data frame.

On the lefthand side of the table, we see the values for `anxiety` since that was the first argument, and on the top, we see the values for `note_mode`, since that was the second argument.

### Proportions

The `table` function gives us raw counts, but we might be interested in finding relative proportions, so that we can more easily see relationships. We can find these proportions using the `prop.table` around the `table` function.

```{r, echo = TRUE}
prop.table(table(exam_scores$anxiety,exam_scores$note_mode))
```

This gives overall proportions, with the sum of all cells in the table summing to 1. Note that this is actually kind of like a two-step process. First, we are finding a table, and the output of the `table` function is a `table` object. This output is then used as the input for the `prop.table` function. We could have also split this process up like the following.

```{r, echo = TRUE}
mytable <- table(exam_scores$anxiety,exam_scores$note_mode)
prop.table(mytable)
```

### 

Row proportions and column proportions can be found by adding an additional `margin` argument to the `prop.table` function. 

Row proportions can be found by using `margin = 1`. The sum of each row should be 1.
```{r, echo = TRUE}
prop.table(table(exam_scores$anxiety,exam_scores$note_mode),margin = 1)
```

Column proportions can be found using `margin = 2`. The sum of each column should be 1.
```{r, echo = TRUE}
prop.table(table(exam_scores$anxiety,exam_scores$note_mode),margin = 2)
```

## Plotting Categorical Variables

### Visualizing Categorical Variables


The basic functions for plotting numerical variables in `R` are shown in the table below. 

|Function|Type of Plot|
|---|---|
|`barplot(x)`|bar chart|
| `pie(x)` | pie chart |
| `barplot(x,y)` | stacked bar chart |


### Visualizing Categorical Variables

The base `R` graphics of categorical variables generally require you to give a table of the data as an argument. For example, let's make a basic barplot.

```{r}
barplot(table(mtcars$vs))
```

You can also use the `pie` function to create a pie chart, but we won't do that here. Remember, using a pie chart is highly discouraged.

To create a stacked bar chart, we can simply use a two-dimensional contingency table.

```{r}
barplot(table(exam_scores$anxiety,exam_scores$note_mode))
```

## Factor

###

If you look back at the exam_scores dataset, you'll notice that there are categorical variables coded as numbers. For example, `note_mode`, referring the method of note-taking, is coded as `1` for paper and `2` for computer. The values of `1` or `2` don't actually mean anything other than to signify that there are two categories. 

However, R doesn't know that! When it see the values of `1` or `2`, it thinks it's a numerical variable, and tries to treat it as such. Therefore, there are time when we might want to convert a variable into a **factor**. A **factor** is just another type of object (like **strings** or **numeric**), which specifically designed to be treated as a categorical variable. You can use the `factor` function in order to tell R to treat a variable as categorical in this way. 

Let's look at an example. If we wanted to use `qplot` to plot a bar plot for the `note_mode` variable, we might try to do this.

```{r, echo = TRUE}
# Remember, qplot is in the ggplot2 package, so you need to bring it in if you have not already in your current R session.
# library(ggplot2)

qplot(note_mode, data = exam_scores)
```

However, this tries to give us a histogram instead of a bar plot, because R thinks it's a numerical variable! We can use `factor` to rectify this.

```{r, echo = TRUE}
qplot(factor(note_mode), data = exam_scores)
```

### Side-by-side boxplots

Recall that we used `qplot` for boxplots, and used `y=` to specify the numerical variables. We can use the `x=` argument to specify which group to split on. 

```{r, echo = TRUE}
qplot(x = factor(note_mode), y = exam1, geom = 'boxplot', data=exam_scores)

```

Note that we had to use `factor` to change `exam_scores$note_mode` into a `factor` object, so that R knows that it is a categorical variable. Otherwise, it will think it is numerical (since it is coded as `1` or `2`), which is not what we want!

## Exercises

### Exercise 1

Suppose we wanted to know how many students reported low, medium, or high anxiety. How would we show just this information?

```{r exercise1, exercise=TRUE}

```

```{r exercise1-check}
grade_result(
  pass_if(~ identical(.result, table(exam_scores$anxiety)), "Good Job!"),
  fail_if(~ TRUE)
)
```

### Exercise 2

What if we wanted to look at the information presented above in a bar plot, using `qplot`?

```{r exercise2, exercise=TRUE}

```

```{r exercise2-check}
grade_result(
  pass_if(~ identical(.result, qplot(factor(anxiety), data = exam_scores)), "Good Job!"),
  pass_if(~ identical(.result, qplot(factor(exam_scores$anxiety))), "Good Job!"),
  fail_if(~ TRUE)
)
```

### Exercise 3

Suppose we wanted to look at boxplots of scores on exam 2 split by low, medium, and high levels of anxiety. How would you do this?

```{r exercise3, exercise=TRUE}

```

```{r exercise3-check}
grade_result(
  pass_if(~ identical(.result, qplot(x = factor(anxiety), y = exam2, geom = 'boxplot', data=exam_scores)), "Good Job!"),
  pass_if(~ identical(.result, qplot(x = factor(exam_scores$anxiety), y = exam_scores$exam2, geom = 'boxplot')), "Good Job!"),
  fail_if(~ TRUE)
)
```

### Exercise 4

```{r exercise4-question}
learnr::question("Based on the graph in Exercise 3, which level of anxiety would you say is associated with the highest test scores?",
         answer("Low", correct=FALSE),
         answer("Medium", correct = TRUE,  message = "Good job!"),
         answer("High",  correct = FALSE),
         allow_retry = TRUE,
         random_answer_order = TRUE
)
```

### Submitting work

```{r submission-setup}
submission_code <- function(UID, exercise = 'data-frames'){
  httr::sha1_hash('catdesc11',as.character(UID))
}
```

Generate your submission code by putting in your UID in the function below. For example, if your UID is `2`, then your code should look like `submission_code(UID = 2)`
```{r submission, exercise = TRUE}
submission_code(UID = )
```
